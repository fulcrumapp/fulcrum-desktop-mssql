'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _util = require('util');

var _fulcrumDesktopPlugin = require('fulcrum-desktop-plugin');

var _lodash = require('lodash');

class MSSQLRecordValues extends _fulcrumDesktopPlugin.RecordValues {
  static setupSearch(values, feature) {
    const searchableValue = feature.searchableValue;

    values.record_index_text = searchableValue;

    const strings = (0, _lodash.compact)(feature.formValues.all.map(o => o.searchableValue && o.searchableValue.trim()));

    values.record_index = JSON.stringify(strings);

    return values;
  }

  static setupPoint(values, latitude, longitude) {
    const wkt = (0, _util.format)('POINT(%s %s)', longitude, latitude);
    return { raw: `geography::STGeomFromText('${wkt}', 4326)` };
  }
}
exports.default = MSSQLRecordValues;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL21zc3FsLXJlY29yZC12YWx1ZXMuanMiXSwibmFtZXMiOlsiTVNTUUxSZWNvcmRWYWx1ZXMiLCJzZXR1cFNlYXJjaCIsInZhbHVlcyIsImZlYXR1cmUiLCJzZWFyY2hhYmxlVmFsdWUiLCJyZWNvcmRfaW5kZXhfdGV4dCIsInN0cmluZ3MiLCJmb3JtVmFsdWVzIiwiYWxsIiwibWFwIiwibyIsInRyaW0iLCJyZWNvcmRfaW5kZXgiLCJKU09OIiwic3RyaW5naWZ5Iiwic2V0dXBQb2ludCIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwid2t0IiwicmF3Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFFZSxNQUFNQSxpQkFBTiw0Q0FBNkM7QUFDMUQsU0FBT0MsV0FBUCxDQUFtQkMsTUFBbkIsRUFBMkJDLE9BQTNCLEVBQW9DO0FBQ2xDLFVBQU1DLGtCQUFrQkQsUUFBUUMsZUFBaEM7O0FBRUFGLFdBQU9HLGlCQUFQLEdBQTJCRCxlQUEzQjs7QUFFQSxVQUFNRSxVQUFVLHFCQUFRSCxRQUFRSSxVQUFSLENBQW1CQyxHQUFuQixDQUF1QkMsR0FBdkIsQ0FBMkJDLEtBQUtBLEVBQUVOLGVBQUYsSUFBcUJNLEVBQUVOLGVBQUYsQ0FBa0JPLElBQWxCLEVBQXJELENBQVIsQ0FBaEI7O0FBRUFULFdBQU9VLFlBQVAsR0FBc0JDLEtBQUtDLFNBQUwsQ0FBZVIsT0FBZixDQUF0Qjs7QUFFQSxXQUFPSixNQUFQO0FBQ0Q7O0FBRUQsU0FBT2EsVUFBUCxDQUFrQmIsTUFBbEIsRUFBMEJjLFFBQTFCLEVBQW9DQyxTQUFwQyxFQUErQztBQUM3QyxVQUFNQyxNQUFNLGtCQUFPLGNBQVAsRUFBdUJELFNBQXZCLEVBQWtDRCxRQUFsQyxDQUFaO0FBQ0EsV0FBTyxFQUFDRyxLQUFNLDhCQUE4QkQsR0FBSyxVQUExQyxFQUFQO0FBQ0Q7QUFoQnlEO2tCQUF2Q2xCLGlCIiwiZmlsZSI6Im1zc3FsLXJlY29yZC12YWx1ZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBmb3JtYXQgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IHsgUmVjb3JkVmFsdWVzIH0gZnJvbSAnZnVsY3J1bSc7XHJcbmltcG9ydCB7IGNvbXBhY3QgfSBmcm9tICdsb2Rhc2gnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTVNTUUxSZWNvcmRWYWx1ZXMgZXh0ZW5kcyBSZWNvcmRWYWx1ZXMge1xyXG4gIHN0YXRpYyBzZXR1cFNlYXJjaCh2YWx1ZXMsIGZlYXR1cmUpIHtcclxuICAgIGNvbnN0IHNlYXJjaGFibGVWYWx1ZSA9IGZlYXR1cmUuc2VhcmNoYWJsZVZhbHVlO1xyXG5cclxuICAgIHZhbHVlcy5yZWNvcmRfaW5kZXhfdGV4dCA9IHNlYXJjaGFibGVWYWx1ZTtcclxuXHJcbiAgICBjb25zdCBzdHJpbmdzID0gY29tcGFjdChmZWF0dXJlLmZvcm1WYWx1ZXMuYWxsLm1hcChvID0+IG8uc2VhcmNoYWJsZVZhbHVlICYmIG8uc2VhcmNoYWJsZVZhbHVlLnRyaW0oKSkpO1xyXG5cclxuICAgIHZhbHVlcy5yZWNvcmRfaW5kZXggPSBKU09OLnN0cmluZ2lmeShzdHJpbmdzKTtcclxuXHJcbiAgICByZXR1cm4gdmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc3RhdGljIHNldHVwUG9pbnQodmFsdWVzLCBsYXRpdHVkZSwgbG9uZ2l0dWRlKSB7XHJcbiAgICBjb25zdCB3a3QgPSBmb3JtYXQoJ1BPSU5UKCVzICVzKScsIGxvbmdpdHVkZSwgbGF0aXR1ZGUpO1xyXG4gICAgcmV0dXJuIHtyYXc6IGBnZW9ncmFwaHk6OlNUR2VvbUZyb21UZXh0KCckeyB3a3QgfScsIDQzMjYpYH07XHJcbiAgfVxyXG59XHJcblxyXG4iXX0=